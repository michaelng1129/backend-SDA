(function(t){function e(e){for(var i,n,o=e[0],c=e[1],l=e[2],d=0,h=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&h.push(s[n][0]),s[n]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],i=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(i=!1)}i&&(r.splice(e--,1),t=n(n.s=a[0]))}return t}var i={},s={app:0},r=[];function n(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=i,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var i=a("85ec"),s=a.n(i);s.a},"043b":function(t,e,a){"use strict";var i=a("964d"),s=a.n(i);s.a},"0671":function(t,e,a){"use strict";var i=a("a19f"),s=a.n(i);s.a},4979:function(t,e,a){"use strict";var i=a("5048"),s=a.n(i);s.a},5048:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("Manager")],1)},r=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-tabs",{on:{"tab-click":t.change_tab},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"语音",name:"first"}},[a("recorder",{on:{record_done:t.display_upload_button,set_speech_data:t.set_speech_data}})],1),a("el-tab-pane",{attrs:{label:"文字",name:"second"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],attrs:{type:"text"},domProps:{value:t.inputText},on:{input:[function(e){e.target.composing||(t.inputText=e.target.value)},t.display_upload_button]}})])],1),t.uploadVisible?a("a",{staticClass:"button rollover",on:{click:t.upload}},[a("span",{staticClass:"roll-text"},[t._v("上传")]),a("span",{staticClass:"roll-text"},[t._v("upload")])]):t._e(),a("video-player",{ref:"videoright"}),a("video-player",{ref:"videowrong"}),a("camera",{on:{set_image_data:t.set_image_data}})],1)},o=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record"},[a("h1",[t._v("Click following button to record voice:")]),a("a",{staticClass:"button rollover",on:{click:t.startRecord}},[a("span",{staticClass:"roll-text"},[t._v("录音")]),a("span",{staticClass:"roll-text"},[t._v("Start")])]),a("a",{staticClass:"button rollover",on:{click:t.stopRecord}},[a("span",{staticClass:"roll-text"},[t._v("停止")]),a("span",{staticClass:"roll-text"},[t._v("Stop")])]),a("a",{staticClass:"button rollover",on:{click:t.play}},[a("span",{staticClass:"roll-text"},[t._v("播放")]),a("span",{staticClass:"roll-text"},[t._v("Play")])]),a("a",{staticClass:"button rollover"},[a("span",{staticClass:"roll-text"},[t._v(t._s(t.score))]),a("span",{staticClass:"roll-text"},[t._v(t._s(t.score))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isFinished,expression:"isFinished"}],staticClass:"record-play"},[a("h2",[t._v("Current voice player is:")]),a("audio",{attrs:{controls:"",autoplay:""}})])])},l=[],u=(a("ac1f"),a("1276"),a("9f12")),d=a("53fe"),h=(a("c19f"),a("ace4"),a("b420"),a("0d03"),a("b0c0"),a("d3b7"),a("e25e"),a("25f0"),a("3ca3"),a("cfc3"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a9"),a("72f7"),a("ddb0"),a("2b3d"),function(){function t(e,a){Object(u["a"])(this,t),window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,a=a||{},a.sampleBits=a.sampleBits||16,a.sampleRate=a.sampleRate||44100,this.context=new(window.webkitAudioContext||window.AudioContext),this.audioInput=this.context.createMediaStreamSource(e),this.createScript=this.context.createScriptProcessor||this.context.createJavaScriptNode,this.recorder=this.createScript.apply(this.context,[4096,1,1]),this.audioData={size:0,buffer:[],inputSampleRate:this.context.sampleRate,inputSampleBits:16,outputSampleRate:a.sampleRate,oututSampleBits:a.sampleBits,input:function(t){this.buffer.push(new Float32Array(t)),this.size+=t.length},compress:function(){for(var t=new Float32Array(this.size),e=0,a=0;a<this.buffer.length;a++)t.set(this.buffer[a],e),e+=this.buffer[a].length;var i=parseInt(this.inputSampleRate/this.outputSampleRate),s=t.length/i,r=new Float32Array(s),n=0,o=0;while(n<s)r[n]=t[o],o+=i,n++;return r},encodeWAV:function(){var t=Math.min(this.inputSampleRate,this.outputSampleRate),e=Math.min(this.inputSampleBits,this.oututSampleBits),a=this.compress(),i=a.length*(e/8),s=new ArrayBuffer(44+i),r=new DataView(s),n=1,o=0,c=function(t){for(var e=0;e<t.length;e++)r.setUint8(o+e,t.charCodeAt(e))};if(c("RIFF"),o+=4,r.setUint32(o,36+i,!0),o+=4,c("WAVE"),o+=4,c("fmt "),o+=4,r.setUint32(o,16,!0),o+=4,r.setUint16(o,1,!0),o+=2,r.setUint16(o,n,!0),o+=2,r.setUint32(o,t,!0),o+=4,r.setUint32(o,n*t*(e/8),!0),o+=4,r.setUint16(o,n*(e/8),!0),o+=2,r.setUint16(o,e,!0),o+=2,c("data"),o+=4,r.setUint32(o,i,!0),o+=4,8===e)for(var l=0;l<a.length;l++,o++){var u=Math.max(-1,Math.min(1,a[l])),d=u<0?32768*u:32767*u;d=parseInt(255/(65535/(d+32768))),r.setInt8(o,d,!0)}else for(var h=0;h<a.length;h++,o+=2){var p=Math.max(-1,Math.min(1,a[h]));r.setInt16(o,p<0?32768*p:32767*p,!0)}return new Blob([r],{type:"audio/wav"})}}}return Object(d["a"])(t,[{key:"start",value:function(){this.audioInput.connect(this.recorder),this.recorder.connect(this.context.destination);var t=this;this.recorder.onaudioprocess=function(e){t.audioData.input(e.inputBuffer.getChannelData(0))}}},{key:"stop",value:function(){this.recorder.disconnect()}},{key:"getBlob",value:function(){return this.stop(),this.audioData.encodeWAV()}},{key:"play",value:function(t){t.src=window.URL.createObjectURL(this.getBlob())}},{key:"clear",value:function(){this.audioData.buffer=[],this.audioData.size=0}}],[{key:"throwError",value:function(t){throw alert("Error:"+t),new function(){this.toString=function(){return t}}}},{key:"canRecording",value:function(){return null!=navigator.getUserMedia}},{key:"get",value:function(e,a){e&&(t.canRecording()?navigator.getUserMedia({audio:!0},(function(i){var s=new t(i,a);e(s)}),(function(e){switch(e.code||e.name){case"PERMISSION_DENIED":case"PermissionDeniedError":t.throwError("用户拒绝提供信息。");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":t.throwError("浏览器不支持硬件设备。");break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":t.throwError("无法发现指定的硬件设备。");break;default:t.throwError("无法打开麦克风。异常信息:"+(e.code||e.name));break}})):t.throwError("当前浏览器不支持录音功能。"))}}]),t}()),p=function(){function t(){Object(u["a"])(this,t)}return Object(d["a"])(t,[{key:"startRecord",value:function(t){var e=this;try{h.get((function(t){e.recorder=t,e.recorder.start()}))}catch(a){t.error("record failed!"+a)}}},{key:"stopRecord",value:function(t){var e=this;try{var a=e.recorder.getBlob();t.success(a)}catch(i){alert("record stop failed!"+i)}}},{key:"play",value:function(t){var e=this;e.recorder.play(t)}}]),t}(),f={name:"Record",data:function(){return{isFinished:!1,audio:"",recorder:new p,score:"发音分数"}},methods:{startRecord:function(){this.isFinished=!1,this.recorder.startRecord({error:function(t){alert("Recording error!"+t)}})},stopRecord:function(){var t=Math.round(30*Math.random())+70;this.score="分数:"+String(t),this.isFinished=!1;var e=this;this.recorder.stopRecord({success:function(t){var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){var t=a.result,i=t.split(",")[1];e.$emit("set_speech_data",i),e.$emit("record_done")}},error:function(){}})},play:function(){var t=this;t.isFinished=!0,t.audio=document.querySelector("audio"),t.recorder.play(t.audio)},test:function(){this.$emit("test-func")}}},v=f,m=(a("043b"),a("2877")),g=Object(m["a"])(v,c,l,!1,null,"d927a860",null),b=g.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"booth"},[a("div",{staticClass:"video"},[a("video",{directives:[{name:"show",rawName:"v-show",value:t.showCam,expression:"showCam"}],ref:"video",attrs:{width:t.width,height:t.height}}),a("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"canvas",attrs:{width:t.width,height:t.height}})]),a("div",{staticClass:"wrap"},[a("a",{staticClass:"button rollover",on:{click:t.start_cam}},[a("span",{staticClass:"roll-text"},[t._v(t._s(t.BtnMsg))]),a("span",{staticClass:"roll-text"},[t._v(t._s(t.BtnMsgNext))])])]),a("img",{ref:"img",attrs:{src:""}})])},w=[],y=(a("4160"),a("159b"),{name:"Camera",data:function(){return{BtnMsg:"Start",BtnMsgNext:"Let‘s Go!",width:400,height:300,stream:0,showCam:!1}},methods:{take_shot:function(){var t=this.$refs.canvas;t.getContext("2d").drawImage(this.$refs.video,0,0,this.width,this.height),this.stop_cam(),this.$refs.img.src=t.toDataURL("image/jpeg");var e=this.$refs.img.src,a=e.split(",")[1];this.$emit("set_image_data",a)},start_cam:function(){"Start"===this.BtnMsg?(this.BtnMsg="Snap a Shot",this.BtnMsgNext="Smile",navigator.mediaDevices.getUserMedia({video:{width:this.width,height:this.height},audio:!1}).then(this.get_media_success)):"Snap a Shot"===this.BtnMsg&&(this.BtnMsg="nice photo",this.BtnMsgNext="nice photo",this.take_shot())},stop_cam:function(){this.stream.getTracks().forEach((function(t){return t.stop()})),this.showCam=!1},get_media_success:function(t){this.showCam=!0,this.$refs.video.srcObject=t,this.$refs.video.play(),this.stream=t}}}),x=y,C=(a("6b63"),Object(m["a"])(x,_,w,!1,null,null,null)),R=C.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"video"},[a("video",{ref:"video"})]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.displayButton,expression:"displayButton"}],staticClass:"button rollover",on:{click:t.play}},[a("span",{staticClass:"roll-text"},[t._v("播放视频")]),a("span",{staticClass:"roll-text"},[t._v("Play")])])])},M=[],k={name:"VideoPlayer",data:function(){return{displayButton:!1}},methods:{set_src:function(t){this.$refs.video.src=t,this.displayButton=!0},play:function(){this.$refs.video.play()}}},U=k,O=(a("4979"),Object(m["a"])(U,S,M,!1,null,"2915728b",null)),B=O.exports,E={name:"app",components:{Camera:R,Recorder:b,VideoPlayer:B},data:function(){return{uploadVisible:!1,imageData:!1,speechData:!1,inputText:"",activeName:"first"}},methods:{video_gen:function(t){this.$refs.video.video_gen(t)},play_video:function(){this.$refs.video.play()},display_upload_button:function(){this.uploadVisible=!0},set_speech_data:function(t){this.speechData=t},set_image_data:function(t){this.imageData=t},upload:function(){var t=this,e={};"first"===this.activeName?e["speech_base64_data"]=this.speechData:"second"===this.activeName&&(e["text_data"]=this.inputText),this.imageData&&(e["img_base64_data"]=this.imageData),this.$ajax.post("/",e).then((function(e){t.$refs.videoright.set_src(e.data.video_generated),t.$refs.videowrong.set_src(e.data.video_generated2)}))},change_tab:function(){this.uploadVisible=!1,this.inputText=""}}},$=E,j=(a("0671"),Object(m["a"])($,n,o,!1,null,"07d06d9a",null)),D=j.exports,N={name:"app",components:{Manager:D}},P=N,T=(a("034f"),Object(m["a"])(P,s,r,!1,null,null,null)),A=T.exports,F=a("5c96"),I=a.n(F),V=(a("0fae"),a("bc3a")),L=a.n(V),z=L.a.create({baseURL:"http://localhost:5000",withCredentials:!0}),G=z;i["default"].config.productionTip=!1,i["default"].use(I.a),i["default"].prototype.$ajax=G,new i["default"]({render:function(t){return t(A)}}).$mount("#app")},"6b63":function(t,e,a){"use strict";var i=a("6cf6"),s=a.n(i);s.a},"6cf6":function(t,e,a){},"85ec":function(t,e,a){},"964d":function(t,e,a){},a19f:function(t,e,a){}});
//# sourceMappingURL=app.c5001e2a.js.map